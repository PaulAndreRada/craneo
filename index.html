<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Craneo by PaulAndreRada</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        
        <img src="./imgs/Craneo_preview.gif" alt="Create bot apps" width="300" height="auto">
        <h1>Craneo</h1>
        <p>A Bare Bones Bot Framework for node.js</p>

        <p class="view"><a href="https://github.com/PaulAndreRada/craneo">View the Project on GitHub <small>PaulAndreRada/craneo</small></a></p>


        <ul>
          <li><a href="https://github.com/PaulAndreRada/craneo/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/PaulAndreRada/craneo/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/PaulAndreRada/craneo">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><b>What it is:</b>
Craneo is a node framework for building a simple chat bot.</p>

<p><b>What it’s not:</b>
Craneo is not an out-of-the-box, artificially intelligent bot; it is simply a framework for building a bot that responds to text-based commands with actions, prompts, or chat responses. In other words, here’s the skull, you supply the brain.
</p>

<h3>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Install</h3>

<p>If you have node.js installed you can simply use npm to download it.</p>

<div class="highlight highlight-source-shell"><pre>npm install craneo</pre></div>

<p></p>

<h2>
<a id="quick-start" class="anchor" href="#quick-start" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Quick Start</h2>

<p>Let’s build a hello world bot program in 3 simple steps then pass it to a Craneo instance.
First install Craneo then create an <code>bot.js</code> file in an empty directory. </p>

<h3>
<a id="create-a-response" class="anchor" href="#create-a-response" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create a response</h3>

<p>This function will be our bot’s response to the words ‘hello’ and ‘arise’. </p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> <span class="pl-en">helloWorld</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(){ 
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>( <span class="pl-s"><span class="pl-pds">"</span>Hello world!<span class="pl-pds">"</span></span> ); 
  <span class="pl-k">return</span> <span class="pl-c1">false</span>;
}</pre></div>

<p></p>

<h3>
<a id="create-a-response-list" class="anchor" href="#create-a-response-list" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create a response list</h3>

<p>In order to have the bot respond to multiple commands we will create a <code>responseList</code> array under our <code>helloWorld</code> function. This array will have a response object named <code>hello</code> and another function named <code>commandNotFound</code>. This will serve as our default response when no other response matches.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> responseList <span class="pl-k">=</span> [
  {
    name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span>,
    response<span class="pl-k">:</span> helloWorld, 
    commands<span class="pl-k">:</span> []
  },
  {
    name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>commandNotFound<span class="pl-pds">"</span></span>,
    <span class="pl-en">response</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){ <span class="pl-en">console</span>.<span class="pl-c1">log</span>( <span class="pl-s"><span class="pl-pds">"</span>I didn’t get that.<span class="pl-pds">"</span></span>);  },
    commands<span class="pl-k">:</span> []
  }
];</pre></div>

<p></p>

<h3>
<a id="add-a-command" class="anchor" href="#add-a-command" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Add a command</h3>

<p>The <code>commands</code> property inside a response object expects an array of regular expressions that will match a response to the incoming message.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// add your commands inside of the response named hello</span>
    commands<span class="pl-k">:</span> [ 
<span class="pl-sr">      <span class="pl-pds">/</span><span class="pl-k">^</span>(<span class="pl-c1">.</span><span class="pl-k">*?</span>(<span class="pl-k">\b</span>hello<span class="pl-k">\b</span>)<span class="pl-c1">[<span class="pl-k">^</span>$]</span><span class="pl-k">*</span>)<span class="pl-k">$</span><span class="pl-pds">/</span>i</span>,
<span class="pl-sr">      <span class="pl-pds">/</span><span class="pl-k">^</span>(<span class="pl-c1">.</span><span class="pl-k">*?</span>(<span class="pl-k">\b</span>arise<span class="pl-k">\b</span>)<span class="pl-c1">[<span class="pl-k">^</span>$]</span><span class="pl-k">*</span>)<span class="pl-k">$</span><span class="pl-pds">/</span>i</span>
    ]</pre></div>

<p></p>

<h3>
<a id="create-a-craneo-instance" class="anchor" href="#create-a-craneo-instance" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create a Craneo Instance</h3>

<p>Now that we built the bot’s commands and responses. 
The only thing left to do is add them to an instance of Craneo and listen to any incoming messages.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Craneo <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">"</span>craneo<span class="pl-pds">"</span></span>);
<span class="pl-k">var</span> myBot <span class="pl-k">=</span> <span class="pl-en">Craneo</span>({ responseList<span class="pl-k">:</span> responseList }); 

<span class="pl-smi">myBot</span>.<span class="pl-en">listen</span>( <span class="pl-s"><span class="pl-pds">"</span>arise<span class="pl-pds">"</span></span> );</pre></div>

<p></p>

<h3>
<a id="its-alive-test-it" class="anchor" href="#its-alive-test-it" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>It’s alive, test it!</h3>

<p>Test out your hello world program by running <code>node app.js</code> on your terminal. The bot should respond with ‘Hello world!’ in your console. Thats it, you have created your first bot!</p>

<p></p>

<h2>
<a id="template" class="anchor" href="#template" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Template</h2>

<p>Looking for a quick way to start your bot?
<a href="https://github.com/PaulAndreRada/craneo-template.git">Download this template</a></p>

<p></p>

<h2>
<a id="docs" class="anchor" href="#docs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Docs</h2>

<h3>
<a id="basic-response" class="anchor" href="#basic-response" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Basic Response</h3>

<p>As shown in our <code>hello-world.js</code> function, a basic response has a series of commands that can match with a users message to trigger a basic response function. These function types should return false. Returning false tells the bot to use the default <code>responseList</code> array for the following responses. As with all other response types a basic response will be passed a context argument with the objects bot and client.
<br></p>

<h3>
<a id="response-chain" class="anchor" href="#response-chain" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Response Chain</h3>

<p>Think of a response chain as a conversation, once a response matches it returns a list or possible responses that are used instead of the default response.  This narrows the bot's available responses to a specific set of actions.  In order to end the response chain, provide a function with <code>return false</code>, this will tell Craneo to go back to using the default responseList.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> <span class="pl-en">responseChain</span> <span class="pl-k">=</span> <span class="pl-k">function</span>( <span class="pl-smi">context</span> ){

  <span class="pl-c">// do your response’s action</span>
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">"</span>A Response chain has started<span class="pl-pds">"</span></span> );

  <span class="pl-c">// Return the following response objects to the bot in the same array format as the default response list</span>
  <span class="pl-k">var</span> responseList <span class="pl-k">=</span> [
    {
      name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>,
      <span class="pl-en">response</span><span class="pl-k">:</span> <span class="pl-k">function</span>( <span class="pl-smi">context</span> ){
          <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">"</span>foo, ending chain<span class="pl-pds">"</span></span>);
          <span class="pl-k">return</span> <span class="pl-c1">false</span>;
      },
      commands<span class="pl-k">:</span> [<span class="pl-sr"> <span class="pl-pds">/</span><span class="pl-k">^</span>(<span class="pl-c1">.</span><span class="pl-k">*?</span>(<span class="pl-k">\b</span>foo<span class="pl-k">\b</span>)<span class="pl-c1">[<span class="pl-k">^</span>$]</span><span class="pl-k">*</span>)<span class="pl-k">$</span><span class="pl-pds">/</span>i</span> ]
    },
    {
      name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>,
      <span class="pl-en">response</span><span class="pl-k">:</span> <span class="pl-k">function</span>( <span class="pl-smi">context</span> ){
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">"</span>bar, ending chain<span class="pl-pds">"</span></span>);
        <span class="pl-k">return</span> <span class="pl-c1">false</span>;
      },
      commands<span class="pl-k">:</span> [<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-k">^</span>(<span class="pl-c1">.</span><span class="pl-k">*?</span>(<span class="pl-k">\b</span>bar<span class="pl-k">\b</span>)<span class="pl-c1">[<span class="pl-k">^</span>$]</span><span class="pl-k">*</span>)<span class="pl-k">$</span><span class="pl-pds">/</span>i</span>]
    },
    {
      name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>commandNotFound<span class="pl-pds">"</span></span>,
      <span class="pl-en">response</span><span class="pl-k">:</span> <span class="pl-k">function</span>(){
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">"</span>command not found in chain<span class="pl-pds">"</span></span>);
        <span class="pl-k">return</span> responseList;
      },
      commands<span class="pl-k">:</span> [],
    }
  ];

  <span class="pl-k">return</span> responseList;
}

<span class="pl-c1">module</span>.<span class="pl-smi">exports</span> <span class="pl-k">=</span> responseChain;</pre></div>

<p><br></p>

<h3>
<a id="read-chain" class="anchor" href="#read-chain" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Read Chain</h3>

<p>A Read Chain is used when you want to parse a message in detail. By returning the string <code>’read’</code> inside of a response along with a <code>responseList</code> property inside that same object the bot will read the message supplied a second time. This time using the responseList supplied inside of the matching object. This can be done in multiple sequences in order to get the most accurate reading of a message. </p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> responseList <span class="pl-k">=</span> 
[
  {
    name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>readChainExample<span class="pl-pds">"</span></span>,
    response<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>read<span class="pl-pds">"</span></span>,
    commands<span class="pl-k">:</span> [<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-k">^</span>(<span class="pl-c1">.</span><span class="pl-k">*?</span>(<span class="pl-k">\b</span>show<span class="pl-k">\b</span>)<span class="pl-c1">[<span class="pl-k">^</span>$]</span><span class="pl-k">*</span>)<span class="pl-k">$</span><span class="pl-pds">/</span>i</span>],
    responseList<span class="pl-k">:</span>
    [
      {
        name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>spaceInvaders<span class="pl-pds">"</span></span>,
        <span class="pl-en">response</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">context</span>){
          <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">"</span>Space Invaders!<span class="pl-pds">"</span></span>);
        },
        commands<span class="pl-k">:</span> [<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-k">^</span>(<span class="pl-c1">.</span><span class="pl-k">*?</span>(<span class="pl-k">\b</span>invaders<span class="pl-k">\b</span>)<span class="pl-c1">[<span class="pl-k">^</span>$]</span><span class="pl-k">*</span>)<span class="pl-k">$</span><span class="pl-pds">/</span>i</span>],
      },
      {
        name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>breakout<span class="pl-pds">"</span></span>,
        <span class="pl-en">response</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">context</span>){
          <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">"</span>Breakout!<span class="pl-pds">"</span></span>);
          <span class="pl-k">return</span> <span class="pl-c1">false</span>;
        },
        commands<span class="pl-k">:</span> [<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-k">^</span>(<span class="pl-c1">.</span><span class="pl-k">*?</span>(<span class="pl-k">\b</span>breakout<span class="pl-k">\b</span>)<span class="pl-c1">[<span class="pl-k">^</span>$]</span><span class="pl-k">*</span>)<span class="pl-k">$</span><span class="pl-pds">/</span>i</span>],
      },
      {
        name<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>commandNotFound<span class="pl-pds">"</span></span>,
        response<span class="pl-k">:</span> commandNotFound,
        commands<span class="pl-k">:</span> []
      }
    ]
  }
]</pre></div>

<h3>
<a id="repeating-commands" class="anchor" href="#repeating-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Repeating commands</h3>

<p>The response list is read in order, repeating a command [regex formatting and context] will result in a matching of the first command of that type only. If there is a need for a command that reads <code>’Show Sapce Invaders’</code> and a command in a different object that reads <code>’Show Breakout’</code> then use a read chain with a command of <code>’show’</code> then pass it a response list that holds the <code>spaceInvaders</code> response and the <code>breakout</code> response; As shown in the example above. This will match the 'show' command first then re-read the same message in order to match the following command.
</p>

<h3>
<a id="passing-down-a-context" class="anchor" href="#passing-down-a-context" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Passing down a context</h3>

<p>All responses will get passed a context argument containing the bot's variables and [your] client's arguments. The <code>context.bot</code> object will pass down the contents necessary for the bot to function; Mainly the message content <code>context.bot.message</code> and the current response list <code>context.bot.responseList</code>.  The <code>context.client</code> object will pass down whatever contents you pass to the bot’s <code>listen</code> method.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// Make your own context variables</span>
<span class="pl-k">var</span> responseArgs  <span class="pl-k">=</span> {
  userId <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>RX78G<span class="pl-pds">"</span></span>, 
  name<span class="pl-k">:</span>  <span class="pl-s"><span class="pl-pds">"</span>Amuro Ray<span class="pl-pds">"</span></span>,
  type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Gundam<span class="pl-pds">"</span></span>
}
<span class="pl-c">// Pass them to the response</span>
<span class="pl-smi">bot</span>.<span class="pl-en">listen</span>( <span class="pl-s"><span class="pl-pds">"</span>Gundams fight!<span class="pl-pds">"</span></span>, responseArgs );</pre></div>

<p><br></p>

<h3>
<a id="command-not-found" class="anchor" href="#command-not-found" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Command Not Found</h3>

<p>Craneo’s parser expects a response named <code>’commandNotFound’</code> inside any response list provided. This allows you to supply a custom function that will be triggered whenever the user adds a command that does not match with your response list’s options. This response should use the same formating as any other response object, but does not need any commands inside the commands array. </p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> responseList <span class="pl-k">=</span> [ 
  { 
   name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>commandNotFound<span class="pl-pds">"</span></span>,
   <span class="pl-en">response</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">context</span>){<span class="pl-k">...</span>},
   commands<span class="pl-k">:</span> []
  } 
]</pre></div>

<p><br><br><br></p>

<h2>
<a id="more-coming-soon" class="anchor" href="#more-coming-soon" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>More coming soon</h2>

<p>Created and maintained by Paul Rada &amp; Licensed under MIT 2016</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/PaulAndreRada">PaulAndreRada</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
